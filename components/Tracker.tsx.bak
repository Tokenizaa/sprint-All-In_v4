import React, { useState, useEffect, useRef } from 'react';
import { 
  BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, CartesianGrid, Legend 
} from 'recharts';
import { CheckCircle, PlusCircle, TrendingUp, Bot, Send, Target, Loader2, Gauge, AlertCircle, Trophy, User as UserIcon, Zap, Calculator, WifiOff } from 'lucide-react';
import { getLogs, saveLog, getLeaderboard } from '../services/storageService';
import { DailyLog, TeamMember, User } from '../types';
import { GoogleGenAI } from "@google/genai";
import { LOCAL_KNOWLEDGE_BASE, QUICK_ACTIONS } from '../constants';
import AdminPanel from './AdminPanel';
import EarningsCalculator from './Calculator';

// --- RAG SEARCH ENGINE UTILITIES ---

const STOP_WORDS = new Set([
  'a', 'o', 'as', 'os', 'um', 'uma', 'uns', 'umas', 'de', 'do', 'da', 'dos', 'das', 
  'em', 'no', 'na', 'nos', 'nas', 
  'por', 'pelo', 'pela', 'pelos', 'pelas', 'para', 'com', 'sem', 'e', 'ou', 'mas', 'que', 'se', 'como', 'quando', 
  'onde', 'quem', 'qual', 'quais', 'quanto', 'quantos', '√©', 's√£o', 'foi', 'foram', 'ser', 'estar', 'ter', 'haver',
  'eu', 'tu', 'ele', 'ela', 'n√≥s', 'v√≥s', 'eles', 'elas', 'meu', 'teu', 'seu', 'nosso', 'vosso', 'isso', 'aquilo',
  'este', 'esta', 'esse', 'essa', 'aquele', 'aquela', 'muito', 'pouco', 'mais', 'menos', 'n√£o', 'sim', 'ent√£o', 'logo'
]);

const stemWord = (word: string): string => {
  // Very basic Portuguese stemmer (suffix removal)
  return word.toLowerCase()
    .replace(/(ar|er|ir|or)$/, '') // verbs infinitive
    .replace(/(s|es)$/, '') // plurals
    .replace(/(indo|endo|ando)$/, '') // gerund
    .replace(/(mente)$/, '') // adverbs
    .replace(/(oso|osa)$/, '') // adjectives
    .replace(/(a|o|e)$/, ''); // gender/theme vowel
};

const tokenize = (text: string): string[] => {
  return text
    .toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g, "") // Remove accents
    .replace(/[^\w\s]/g, '') // Remove punctuation
    .split(/\s+/)
    .filter(w => w.length > 2 && !STOP_WORDS.has(w)) // Filter stop words and short words
    .map(stemWord);
};

interface KnowledgeChunk {
  title: string;
  content: string;
  tokens: string[];
  originalText: string;
}

// External RAG content to be integrated with the local knowledge base
const EXTERNAL_RAG_CONTENT = `
# ARQUIVO RAG 1 - RELAT√ìRIO DE ESTRAT√âGIA COMERCIAL

## I. Introdu√ß√£o Estrat√©gica: O Paradigma Data-Driven na Distribui√ß√£o

A performance superior no setor de distribui√ß√£o, marcado por uma concorr√™ncia acirrada e consumidores cada vez mais exigentes, exige uma redefini√ß√£o das prioridades comerciais. O √™xito vai al√©m das t√°ticas de venda isoladas; ele reside na constru√ß√£o de um framework estrat√©gico robusto, centrado na intelig√™ncia de dados e na excel√™ncia do relacionamento com o cliente.

### 1.1. O Cen√°rio Atual e a Converg√™ncia Vendas-Atendimento

A competitividade moderna demanda uma compreens√£o profunda do comportamento de compra e a capacidade de adaptar rapidamente as ofertas. Para os distribuidores, isso implica uma integra√ß√£o funcional onde as √°reas de Vendas e Atendimento, incluindo Log√≠stica e Financeiro, operem em plena sintonia. O sucesso na execu√ß√£o de vendas depende de uma comunica√ß√£o clara e sem ru√≠dos entre todos os setores da organiza√ß√£o, garantindo o escoamento eficiente dos produtos e o alinhamento das atividades-chave.

### 1.2. O Papel da Tecnologia como Habilitador de Produtividade

A efici√™ncia de vendas (fazer mais com menos tempo) e a efic√°cia de vendas (fechar o neg√≥cio certo) s√£o conceitos insepar√°veis. Para maximizar a produtividade dos distribuidores, a tecnologia se torna crucial. A utiliza√ß√£o de sistemas de Gest√£o de Relacionamento com o Cliente (CRM) e de Planejamento de Recursos Empresariais (ERP) permite a automa√ß√£o de fluxos de trabalho e o rastreamento detalhado de atividades.

A infraestrutura tecnol√≥gica adequada (CRM/ERP) √© o pr√©-requisito fundamental para a efic√°cia do distribuidor. Quando os sistemas est√£o integrados, processos que demandavam horas passam a ser conclu√≠dos em minutos, reduzindo o estresse operacional e o retrabalho. Essa otimiza√ß√£o de tempo √© essencial, pois libera a equipe de tarefas burocr√°ticas para que possam dedicar maior foco em atividades de alto valor, como a an√°lise de dados, a criatividade na prospec√ß√£o e a negocia√ß√£o consultiva com clientes. Sem essa funda√ß√£o tecnol√≥gica s√≥lida, o distribuidor n√£o consegue alocar tempo para o relacionamento estrat√©gico e a an√°lise de desempenho.

## II. Intelig√™ncia Comercial: Transformando Hist√≥rico de Vendas em Oportunidades

O hist√≥rico de vendas √© o principal ativo estrat√©gico de um distribuidor, fornecendo a base emp√≠rica para todas as decis√µes de mercado. O seu uso eficiente move a opera√ß√£o de uma gest√£o reativa para um modelo preditivo.

### 2.1. Acesso Estrat√©gico e Organiza√ß√£o do Hist√≥rico de Clientes

Para que o hist√≥rico seja √∫til, ele precisa ser centralizado e de f√°cil acesso. Organizar os dados em um CRM √© vital para uma gest√£o comercial estrat√©gica, garantindo que os dados estejam sempre prontos para gerar percep√ß√µes valiosas. A aus√™ncia de acesso imediato ao hist√≥rico de pedidos do cliente no cotidiano compromete significativamente a performance de vendas.

Ao monitorar o hist√≥rico de vendas, a gest√£o obt√©m acesso a indicadores criados a partir de dados reais e precisos, facilitando a tomada de decis√µes mais estrat√©gicas. Especificamente no setor de distribui√ß√£o, o hist√≥rico possibilita a previs√£o de tend√™ncias de consumo e a proje√ß√£o de necessidades futuras, auxiliando na cria√ß√£o de estrat√©gias assertivas, como promo√ß√µes para produtos de baixa sa√≠da ou refor√ßo de estoque para itens de alta procura em √©pocas sazonais.

Adicionalmente, o hist√≥rico serve como uma ferramenta de gest√£o de risco. Ele auxilia na identifica√ß√£o de consumidores que historicamente apresentam dificuldades em cumprir obriga√ß√µes financeiras, orientando a decis√£o de vender ou n√£o a prazo e influenciando diretamente a sa√∫de financeira do neg√≥cio. A desorganiza√ß√£o ou a falta de acesso ao hist√≥rico gera decis√µes subjetivas e resulta em tempo desperdi√ßado em retrabalho, diminuindo o foco na negocia√ß√£o e no relacionamento com o cliente.

### 2.2. Segmenta√ß√£o Acion√°vel: A Matriz RFV (Rec√™ncia, Frequ√™ncia, Valor Monet√°rio)

A Matriz RFV (ou RFM) √© a metodologia mais eficaz para segmentar a base de clientes com base em seu comportamento transacional, permitindo a cria√ß√£o de campanhas personalizadas altamente direcionadas.

#### 2.2.1. Defini√ß√£o e Processo de Pontua√ß√£o

A matriz utiliza tr√™s indicadores-chave para segmenta√ß√£o:
- **Rec√™ncia (R)**: Mede o tempo decorrido desde a √∫ltima compra. Clientes que compraram mais recentemente recebem pontua√ß√µes mais altas, indicando maior engajamento.
- **Frequ√™ncia (F)**: Avalia a regularidade com que o cliente realiza compras em um determinado per√≠odo.
- **Valor Monet√°rio (V)**: Reflete o gasto total ou m√©dio do cliente.

O processo de segmenta√ß√£o RFV envolve classificar os clientes, tipicamente em uma escala de 1 a 5, onde os 20% melhores em cada crit√©rio recebem a pontua√ß√£o m√°xima (5). Ao cruzar essas pontua√ß√µes, o distribuidor pode identificar perfis distintos, desde os mais engajados at√© aqueles que est√£o pr√≥ximos de se tornar inativos.

A aplica√ß√£o da Matriz RFV √© essencial, pois as campanhas gen√©ricas deixaram de ser eficazes. A segmenta√ß√£o permite abordagens personalizadas para reativar clientes "dormindo", fidelizar compradores frequentes com benef√≠cios VIP e estimular novos clientes a se tornarem recorrentes, tornando a comunica√ß√£o mais eficaz.

##### Exemplo de Segmenta√ß√£o RFV e A√ß√µes Estrat√©gicas:

| Segmento RFV | Perfil Comportamental | A√ß√£o Estrat√©gica Prim√°ria | Objetivo |
|--------------|----------------------|---------------------------|----------|
| Clientes Leais (555) | Compra recente, frequente, alto gasto | Programas de fidelidade, ofertas exclusivas (VIP) | Reten√ß√£o e est√≠mulo ao Word-of-Mouth |
| Em Risco (4XX - 5XX) | Compra recente, mas frequ√™ncia/valor declinando | Prospec√ß√£o consultiva de Upsell/Cross-Sell | Aumentar Ticket M√©dio/Recorr√™ncia |
| Clientes Dormindo (1XX - 2XX) | N√£o compram h√° muito tempo, mas tinham hist√≥rico positivo | Campanhas de reativa√ß√£o com ofertas de alto valor | Recupera√ß√£o de Receita Perdida |
| Novos Clientes (511) | Primeira compra recente | Onboarding proativo e follow-up para incentivar a segunda compra | Acelera√ß√£o para Recorr√™ncia |

#### 2.2.2. A Evolu√ß√£o da Segmenta√ß√£o

Embora o modelo RFV seja simples de implementar e ofere√ßa √≥timos resultados, ele se limita a apenas tr√™s atributos. Para distribuidores que buscam um crescimento mais sofisticado, a evolu√ß√£o natural √© incorporar algoritmos de machine learning. Essas t√©cnicas permitem a cria√ß√£o de segmentos baseados em uma infinidade de atributos, como regi√£o, n√∫mero de produtos devolvidos, e taxa de cancelamentos, proporcionando uma granularidade de dados superior √† do modelo tradicional.

### 2.3. Estrat√©gias de Upsell e Cross-Sell Baseadas em Dados

A an√°lise hist√≥rica deve ser aplicada para identificar oportunidades de venda incremental. As estrat√©gias de Upsell (vender uma vers√£o melhor ou mais cara) e Cross-Sell (vender produtos complementares) s√£o altamente eficazes quando baseadas em padr√µes de compra anteriores. O distribuidor deve analisar o que o cliente comprou e, crucialmente, o que ele deixou de comprar que seria logicamente complementar ao seu pedido habitual.

A cria√ß√£o de ofertas complementares, ou a sugest√£o de vers√µes premium, deve ocorrer em momentos estrat√©gicos, como durante o processo de checkout ou em um follow-up proativo ap√≥s a primeira compra. A inclus√£o de pacotes promocionais ou "ofertas por tempo limitado" pode criar um senso de urg√™ncia e aumentar o valor percebido, potencializando a taxa de sucesso dessas abordagens.

## III. Gest√£o de Clientes: Dominando Obje√ß√µes e Conflitos

A capacidade de identificar e contornar obje√ß√µes com profissionalismo e empatia √© o cerne do atendimento de alta performance. Obje√ß√µes s√£o frequentemente o resultado de incertezas ou dores n√£o endere√ßadas, e n√£o uma rejei√ß√£o final.

### 3.1. Identifica√ß√£o de Sinais de Resist√™ncia (Verbal e N√£o Verbal)

O primeiro passo √© reconhecer os sinais de resist√™ncia. As obje√ß√µes verbais mais comuns se agrupam em categorias previs√≠veis, como Pre√ßo ("√â muito caro"), Necessidade ("N√£o precisamos disto"), Valor ("N√£o vejo o benef√≠cio"), Urg√™ncia ("N√£o √© o momento certo") e Concorr√™ncia ("J√° trabalho com o concorrente X").

No entanto, em negocia√ß√µes presenciais, a linguagem corporal (comunica√ß√£o n√£o verbal) oferece pistas importantes. Inconsist√™ncias entre o que √© dito e a postura do cliente geram desconfian√ßa imediata. Sinais de linguagem corporal negativa que indicam resist√™ncia incluem:
- Postura Defensiva: Bra√ßos cruzados, sugerindo fechamento, mesmo que a fala seja polida.
- Impaci√™ncia ou Agressividade: P√©s inquietos ou m√£os na cintura.
- Desinteresse: Ritmo de fala lento, ou, inversamente, fala excessivamente r√°pida que dificulta a compreens√£o.

Para garantir que a equipe saiba alinhar seu pr√≥prio discurso com a postura (e identificar incongru√™ncias nos clientes), o treinamento deve incluir a pr√°tica de simula√ß√µes de atendimento. Ajustes simples, como manter as m√£os abertas, podem uniformizar o discurso e transmitir confian√ßa.

### 3.2. T√©cnicas Estruturadas para Contorno de Obje√ß√µes

Saber lidar com obje√ß√µes aumenta a percep√ß√£o de valor da solu√ß√£o oferecida, pois informa o consumidor, permitindo-lhe tomar uma decis√£o consciente.

#### 3.2.1. O Uso da Argumenta√ß√£o e Evid√™ncia

O distribuidor deve priorizar a escuta ativa, garantindo que o cliente se sinta compreendido antes de tentar vender a solu√ß√£o. A argumenta√ß√£o deve ser apoiada por fatos. T√©cnicas eficazes incluem o uso de storytelling, criando narrativas com personagens fict√≠cios que superaram desafios semelhantes, ou a demonstra√ß√£o pr√°tica dos resultados atrav√©s de cases de sucesso com empresas do mesmo ramo de atua√ß√£o do cliente.

#### 3.2.2. Lidando com Obje√ß√µes de Pre√ßo e Concorr√™ncia

Ao enfrentar a obje√ß√£o de pre√ßo, a t√°tica deve ser refor√ßar o Valor sobre o Custo. O pre√ßo pode estar um pouco acima, mas o diferencial se manifestar√° no uso e nos resultados de longo prazo. √â fundamental que, ao comparar-se com a concorr√™ncia, o distribuidor evite denegrir, focando em vez disso em destacar o benef√≠cio superior que sua oferta proporciona.

##### Tabela: Obje√ß√µes Cr√≠ticas e Scripts de Valor

| Obje√ß√£o (Raiz da Incerteza) | Resposta Anal√≠tica | Dica de Implementa√ß√£o |
|-----------------------------|--------------------|-----------------------|
| "√â muito caro." (Pre√ßo) | Foco no Retorno sobre o Investimento (ROI) e durabilidade do produto | Questionar a diferen√ßa de pre√ßo em percentual e justificar que o custo-benef√≠cio se revelar√° com o passar dos anos |
| "Estou satisfeito com o concorrente." (Concorr√™ncia) | √änfase no Valor Agregado √önico | Perguntar quem usar√° o produto e destacar como o seu produto oferece um benef√≠cio superior ou uma caracter√≠stica que falta ao concorrente |
| "N√£o vejo como isso pode nos ajudar." (Valor) | Prova Social e Demonstra√ß√£o | Apresentar casos de sucesso reais e quantific√°veis de empresas similares ao prospect |

### 3.3. Lidando com Clientes Dif√≠ceis (Atendimento de Crise)

Em momentos de insatisfa√ß√£o do cliente, √© imperativo separar o pessoal do profissional. A insatisfa√ß√£o √© geralmente uma resposta √† experi√™ncia, e n√£o um ataque pessoal. Manter o profissionalismo refor√ßa a credibilidade da empresa, mesmo em situa√ß√µes adversas.

#### 3.3.1. Desescalada e Foco Factual

A primeira medida √© pedir desculpas pelo inconveniente, mesmo que o atendente n√£o concorde com a situa√ß√£o. Um "sinto muito" genu√≠no contribui significativamente para desescalar a tens√£o. Quando o cliente est√° dominado por emo√ß√µes, √© mais produtivo direcionar a conversa para fatos objetivos e concretos, o que ajuda o cliente a se concentrar em fornecer informa√ß√µes, em vez de desabafar.

#### 3.3.2. Uso da Empatia Estruturada

Frases de empatia s√£o essenciais para criar um di√°logo positivo. Elas demonstram que o atendente est√° atento √†s necessidades e comprometido com a resolu√ß√£o. Exemplos pr√°ticos incluem: "Entendo sua frustra√ß√£o. Vamos trabalhar juntos para resolver isso" ou "Agrade√ßo por nos informar, estamos comprometidos em encontrar a melhor solu√ß√£o".

Quando for necess√°rio escalar o problema, o processo deve ser transparente e organizado. O distribuidor deve informar o gestor de maneira completa, incluindo o hist√≥rico do cliente e as a√ß√µes j√° tomadas. Deve-se tamb√©m informar o cliente sobre o escalonamento, o que demonstra compromisso com a resolu√ß√£o e respeito pela situa√ß√£o.

## IV. Estrat√©gias Proativas para Maximiza√ß√£o de Vendas Di√°rias

Para impulsionar o volume de vendas di√°rias de forma sustent√°vel, o distribuidor deve adotar abordagens proativas de prospec√ß√£o, reativa√ß√£o e gerenciamento de funil.

### 4.1. Prospec√ß√£o Ativa Estruturada e Qualifica√ß√£o de Leads

A prospec√ß√£o ativa √© a iniciativa de ir atr√°s dos clientes, em vez de esperar que eles cheguem at√© a empresa. Isso engloba liga√ß√µes frias, envio de e-mails e intera√ß√µes estrat√©gicas em redes sociais, com o objetivo de engajar potenciais clientes que se beneficiariam das solu√ß√µes oferecidas.

A prospec√ß√£o ativa alcan√ßa resultados exponenciais quando combinada com o Inbound Marketing, onde a atra√ß√£o natural de leads via conte√∫do relevante √© complementada pela a√ß√£o proativa de vendas, garantindo um fluxo constante de novas oportunidades.

√â fundamental que o distribuidor qualifique os leads de forma rigorosa antes de investir tempo, garantindo que os esfor√ßos se concentrem em oportunidades com alta probabilidade de convers√£o. A abordagem deve ser multicanal, mesclando telefone, e-mail e redes sociais. Al√©m das intera√ß√µes digitais, o gerente de vendas deve estimular os distribuidores a visitarem clientes na rua, dedicando tempo para desenvolver novos neg√≥cios e fortalecer o relacionamento com a base existente.

### 4.2. Reativa√ß√£o Estrat√©gica de Clientes Inativos

A reativa√ß√£o √© uma fonte de receita frequentemente negligenciada. A Matriz RFV (Se√ß√£o 2.2) deve ser usada para classificar e priorizar os "Clientes Dormindo" ou "Perdidos" que, historicamente, tinham alto Valor e Frequ√™ncia de compra.

A reativa√ß√£o deve ser baseada em dados de consumo para atrair novamente os clientes esquecidos. Para os clientes inativos, a estrat√©gia mais eficaz √© implementar a√ß√µes urgentes e personalizadas, como ofertas de alto valor ou benef√≠cios VIP tempor√°rios, para recuperar a receita perdida e incentiv√°-los a retomar o ciclo de recorr√™ncia.

### 4.3. Otimiza√ß√£o e Automa√ß√£o do Follow-up

O acompanhamento (follow-up) √© a etapa mais cr√≠tica para fechar neg√≥cios e construir relacionamentos duradouros. Estat√≠sticas indicam que aproximadamente 80% das vendas podem exigir at√© cinco contatos antes do fechamento. A perseveran√ßa e o acompanhamento pr√≥ximo s√£o cruciais, e a cren√ßa de que o follow-up incomoda o cliente deve ser desmistificada, desde que seja um acompanhamento proativo e √∫til.

Para o distribuidor que lida com m√∫ltiplos leads, a automa√ß√£o do follow-up √© indispens√°vel. O CRM deve ser configurado para gerar alertas, gatilhos e fluxos de trabalho que automatizam o envio de e-mails e agendam tarefas para o vendedor, garantindo que nenhuma oportunidade seja esquecida. A utiliza√ß√£o de um CRM com automa√ß√£o integrada proporciona uma vis√£o de 360 graus do lead, permitindo que os vendedores usem modelos e scripts prontos, ajustando-os com personaliza√ß√£o, para garantir comunica√ß√µes eficazes.

### 4.4. Uso Estrat√©gico de Redes Sociais e Comunica√ß√£o Digital

As redes sociais se consolidaram como canais diretos de vendas (S-commerce) e ferramentas de relacionamento. O distribuidor deve utiliz√°-las de forma estrat√©gica para maximizar os resultados.

As plataformas oferecem op√ß√µes robustas de an√∫ncios pagos que podem ser altamente direcionados a segmentos espec√≠ficos da audi√™ncia. Ao integrar os dados de consumo do hist√≥rico de vendas com as ferramentas de segmenta√ß√£o das redes sociais, √© poss√≠vel impulsionar promo√ß√µes exclusivas e aumentar o alcance das publica√ß√µes, transformando a audi√™ncia em potenciais clientes de forma eficiente.

## V. Framework de Alto Desempenho: Monitoramento, Feedback e Desenvolvimento Cont√≠nuo

O aprimoramento cont√≠nuo da performance exige um sistema de gest√£o estruturado que defina metas, monitore o progresso e garanta o desenvolvimento das habilidades da equipe.

### 5.1. Defini√ß√£o e Monitoramento de Metas com KPIs

Indicadores-Chave de Desempenho (KPIs) s√£o os valores quantitativos que medem os processos internos mais vitais de uma empresa. Eles s√£o essenciais, pois d√£o dire√ß√£o e ritmo √† opera√ß√£o comercial, traduzindo objetivos estrat√©gicos em n√∫meros que orientam prioridades di√°rias. √â importante n√£o confundir KPIs com m√©tricas; KPIs s√£o as principais medidas da estrat√©gia, enquanto m√©tricas s√£o apenas medidas simples de valor ou quantidade.

O acompanhamento criterioso dos KPIs revela gargalos no funil de vendas, sustenta a defini√ß√£o de metas realistas e garante o alinhamento entre a gest√£o e o campo. O monitoramento deve ser di√°rio e facilitado por dashboards visuais fornecidos pelo CRM, permitindo corre√ß√µes r√°pidas antes que problemas se agravem.

##### Tabela: KPIs Essenciais para Gest√£o da Performance de Distribuidores

| Categoria KPI | Indicador-Chave de Desempenho | Significado Estrat√©gico | Melhora a... |
|---------------|-------------------------------|-------------------------|--------------|
| Produtividade | Redu√ß√£o do Tempo M√©dio de Resposta (TMR) ao Lead | Agilidade da equipe no primeiro contato, crucial para a convers√£o | Efici√™ncia e Convers√£o |
| Efic√°cia do Funil | Taxa de Convers√£o de Leads Qualificados | Mede a qualidade do processo de prospec√ß√£o e a capacidade de fechar neg√≥cios | Foco e Resultado |
| Rentabilidade | Custo de Aquisi√ß√£o do Cliente (CAC) | Valor investido para conquistar novos clientes, crucial para a sustentabilidade da prospec√ß√£o | Estrat√©gia de Prospec√ß√£o |
| Reten√ß√£o | Lifetime Value (LTV) / Taxa de Reten√ß√£o | Rentabilidade que o cliente gera ao longo de seu relacionamento com a empresa | Sustentabilidade do Neg√≥cio |

### 5.2. A Cultura do Feedback Cont√≠nuo e Construtivo

O feedback √© uma ferramenta poderosa de desenvolvimento profissional, promovendo uma mentalidade de aprendizado cont√≠nuo. Para a gest√£o, ele deve ser aplicado de forma cont√≠nua, construtiva e contextualizada, fazendo parte da rotina, e n√£o um evento pontual de cr√≠tica. A const√¢ncia do feedback cont√≠nuo reduz a tens√£o e transforma-o em um instrumento de confian√ßa, e n√£o de controle.

#### 5.2.1. Modelos de Feedback Estruturado

Para garantir que o feedback seja objetivo e acion√°vel, o distribuidor deve adotar modelos estruturados:
- **T√©cnica SCI (Situa√ß√£o, Comportamento, Impacto)**: Este modelo garante que o retorno seja espec√≠fico, evitando elogios gen√©ricos e cr√≠ticas vagas. A estrutura consiste em descrever a Situa√ß√£o (contexto em que ocorreu), o Comportamento observado (a a√ß√£o realizada) e o Impacto gerado por essa a√ß√£o (o resultado).
- **Modelo GROW (Goal, Reality, Options, Will)**: Este modelo √© ideal para o coaching gerencial. Ele permite estruturar o feedback de forma a derivar a√ß√µes para atingir os objetivos desejados. O gestor auxilia o distribuidor a definir Metas (Goal), analisar a Realidade atual (Reality), explorar Op√ß√µes de a√ß√£o (Options) e firmar um Compromisso com a a√ß√£o (Will).

A humaniza√ß√£o e o profissionalismo devem andar juntos, pois o feedback funciona como um motivador que refor√ßa o reconhecimento e aumenta o engajamento e o senso de realiza√ß√£o no funcion√°rio.

### 5.3. Treinamento Espec√≠fico e Plano de Desenvolvimento de Habilidades (PDP)

A evolu√ß√£o da performance exige um desenvolvimento cont√≠nuo de compet√™ncias. O Plano de Desenvolvimento de Habilidades (PDP) √© uma ferramenta essencial para monitorar o crescimento dos distribuidores, listando metas, tarefas e prazos.

O PDP deve detalhar a categoria de habilidades, a profici√™ncia atual e a desejada, o m√©todo de treinamento e o status do desenvolvimento. Os temas centrais de treinamento para distribuidores devem incluir:
- Fundamentos de CRM: Uso da ferramenta para gest√£o de funil e automa√ß√£o de follow-up.
- T√©cnicas Avan√ßadas de Vendas: Metodologias como Challenger Activation, focada em entender as necessidades do cliente, oferecer insights importantes e facilitar a a√ß√£o do cliente.
- Comunica√ß√£o e Negocia√ß√£o: Aprimoramento da clareza, objetividade e t√©cnicas de empatia no atendimento.

Os programas de treinamento devem ser mistos, utilizando cursos presenciais, sess√µes online ao vivo e, se poss√≠vel, simuladores com feedback baseado em intelig√™ncia artificial, garantindo que os profissionais estejam totalmente qualificados para qualquer cen√°rio de vendas.

## VI. Conclus√£o e Plano de Implementa√ß√£o Estrat√©gica

A maximiza√ß√£o da performance de distribuidores √© uma tarefa de gest√£o cont√≠nua, ancorada na intelig√™ncia de dados e na capacita√ß√£o humana. O desempenho superior √© constru√≠do atrav√©s da integra√ß√£o de sistemas, da personaliza√ß√£o das intera√ß√µes com o cliente e de um ciclo de gest√£o de performance rigoroso.

Para alcan√ßar a excel√™ncia, o foco deve ser a convers√£o da efici√™ncia operacional (garantida pela tecnologia) em efic√°cia estrat√©gica (garantida pelas habilidades e pelo uso dos dados).

### Plano de A√ß√£o Sugerido para a Distribui√ß√£o:

| Prioridade | A√ß√£o Estrat√©gica | Objetivo de Performance |
|------------|------------------|-------------------------|
| Imediata (Processos) | 1. Integra√ß√£o e Automa√ß√£o de Dados: Garantir que todos os distribuidores tenham acesso imediato ao hist√≥rico de vendas via CRM/ERP. Automatizar alertas de follow-up e tarefas de reativa√ß√£o de clientes inativos | Converter tempo burocr√°tico em tempo de negocia√ß√£o |
| Curto Prazo (Habilidades) | 2. Treinamento de Conflitos e Obje√ß√µes: Implementar simula√ß√µes de atendimento focadas em identificar sinais n√£o verbais de resist√™ncia e aplicar scripts de valor para contornar obje√ß√µes de Pre√ßo e Concorr√™ncia | Aumentar a taxa de convers√£o do funil de vendas |
| Curto Prazo (Gest√£o) | 3. Adotar o Framework de Feedback: Instituir a cultura de feedback cont√≠nuo utilizando o Modelo SCI (Situa√ß√£o, Comportamento, Impacto) para garantir que as devolutivas sejam espec√≠ficas e acion√°veis | Promover o desenvolvimento cont√≠nuo e a motiva√ß√£o da equipe |
| M√©dio Prazo (Intelig√™ncia) | 4. Implementar Segmenta√ß√£o RFV: Adotar a Matriz RFV como padr√£o operacional para segmenta√ß√£o da base de clientes. Criar campanhas direcionadas para os segmentos de "Clientes Dormindo" e "Em Risco" | Recuperar receita perdida e aumentar o Lifetime Value (LTV) |
| M√©dio Prazo (Monitoramento) | 5. Gest√£o por KPIs: Definir e monitorar semanalmente um dashboard com os KPIs essenciais (TMR, CAC e Taxa de Convers√£o de Leads Qualificados), utilizando esses dados para realinhar prioridades di√°rias | Garantir que os esfor√ßos de vendas estejam alinhados aos objetivos estrat√©gicos da organiza√ß√£o |

# ARQUIVO RAG 2 - AGENTE ALLIN - ASSISTENTE VIRTUAL PARA IA NO INSTAGRAM

## PERFIL DO AGENTE

Ol√°! Eu sou o Agente Allin, o assistente virtual da marca Allin ‚Äî especialista em t√™nis terap√™uticos que combinam conforto, estilo e tecnologia. Estou aqui para ajudar voc√™ a encontrar o modelo ideal conforme sua necessidade: dores nos p√©s, m√° circula√ß√£o, incha√ßo, cansa√ßo nas pernas ou longos per√≠odos em p√©.

## CAT√ÅLOGO DE PRODUTOS

### üéØ Modelos oficiais Allin:
- ALL CLASSIC (All Black, Azul, Branco, Brisa, Chumbo, Lil√°s, Linho Reciclado, Marsala, Preto, Renovi, Rose, Verde, Vermelho)
- ALL FIT NEON
- ALL SHINE (Pink, Preto)
- SPORT TOTAL BLACK
- BUMPER (Black, Laranja, Neon, White)
- CASUALL (Black, Dark, Green, Grey)
- NEW COMFY (Preta, Nude)
- SPORT BALANCE (Preto, Nude)
- TRACTOR (Black, Green)
- SUMMER SPORT TURQUESA
- Summer Peach (edi√ß√£o limitada)

### üëü Produtos adicionais autorizados:
- Chinelos CLOUD
- Palmilha ConfortPlus
- Meias Emana
- Faixas
- Cal√ßas Emana
- Mantas Ativa
- Caderneta Allin

## üìå TECNOLOGIAS TERAP√äUTICAS

### Magnetoterapia
Estimula a circula√ß√£o e alivia tens√µes.

### Infravermelho longo
Contribui para relaxamento muscular.

### Tecido knit respir√°vel
Conforto t√©rmico e leveza.

## ‚ö†Ô∏è REGRAS IMPORTANTES

1. N√£o mencionar produtos que n√£o existem no cat√°logo.
2. Nunca falar de sand√°lias, sapatos sociais ou cal√ßados ortop√©dicos.
3. N√£o prometa cura ou resultados m√©dicos.
4. Use linguagem acolhedora, profissional e objetiva.

## ü§ù ATENDIMENTO AO CLIENTE OU REVENDEDOR?

Estou aqui para orientar, tirar d√∫vidas e, se necess√°rio, te redirecionar para o suporte humano.

## üí¨ COMENTOU "EU QUERO"?

Posso te mostrar os modelos e indicar como comprar! Acesse: https://allinbrasil.com.br/

# INSTRU√á√ïES DO AGENTE ALLIN PARA IA NO INSTAGRAM (META AI STUDIO)

## ‚úÖ Instru√ß√£o 1
**Atenda clientes e distribuidores com foco nos benef√≠cios reais dos t√™nis Allin.**
Sempre foque nas vantagens terap√™uticas dos modelos, como al√≠vio de dores, melhora na circula√ß√£o e conforto prolongado. A IA deve se posicionar como uma especialista em produtos de bem-estar.

## ‚úÖ Instru√ß√£o 2
**Use linguagem profissional, clara e acolhedora.**
Evite g√≠rias e express√µes informais. Adote um tom positivo, emp√°tico e educativo, transmitindo confian√ßa e autoridade sem parecer mec√¢nico.

## ‚úÖ Instru√ß√£o 3
**N√£o mencione sapatos sociais, sand√°lias ou cal√ßados fora da linha Allin.**
Limite as respostas apenas aos produtos oficiais da Allin: t√™nis terap√™uticos com tecnologias voltadas para bem-estar, conforto e estilo.

## ‚úÖ Instru√ß√£o 4
**Evite o termo "ortop√©dico".**
Utilize sempre "t√™nis terap√™utico". A marca n√£o promete efeitos m√©dicos, mas oferece al√≠vio de desconfortos comuns com foco em preven√ß√£o e qualidade de vida.

## ‚úÖ Instru√ß√£o 5
**Explique as tecnologias da marca com clareza.**
Ao mencionar magnetoterapia, infravermelho longo e tecido knit, explique de forma simples o que cada uma faz e como beneficia o cliente.

## ‚úÖ Instru√ß√£o 6
**Redirecione clientes finais para o agente de atendimento ao cliente.**
Caso a d√∫vida envolva pagamento, entrega, garantias ou trocas, indique educadamente o canal oficial de atendimento.

## ‚úÖ Instru√ß√£o 7
**Redirecione distribuidores para o agente de suporte ao distribuidor.**
Se o interesse for revenda, ativa√ß√£o de conta ou d√∫vidas sobre comiss√£o, oriente o usu√°rio para o agente correto.

## ‚úÖ Instru√ß√£o 8
**Nunca invente produtos fora da linha Allin.**
Foque apenas nos modelos terap√™uticos com tecnologias aprovadas pela marca. Evite qualquer especula√ß√£o sobre produtos futuros ou n√£o existentes.

## ‚úÖ Instru√ß√£o 9
**Use emojis com modera√ß√£o.**
Utilize apenas para dar leveza, como üëü, üìÜ ou üòä. Nunca exagere ou use emojis fora de contexto.

## ‚úÖ Instru√ß√£o 10
**Garanta respostas objetivas e relevantes.**
Evite par√°grafos longos e repeti√ß√µes. Foque em entregar valor com poucas palavras, sendo direto, sem perder a empatia.

## ‚úÖ Instru√ß√£o 11
**Priorize empatia na conversa.**
Demonstre compreens√£o ao ouvir problemas como dores, incha√ßo, cansa√ßo. Mostre-se interessado em ajudar com o produto certo.

## ‚úÖ Instru√ß√£o 12
**Se o usu√°rio perguntar sobre pre√ßos, oriente para o distribuidor ou link da loja.**
N√£o mencione valores. Responda com frases como: "Posso te encaminhar para o distribuidor da sua regi√£o" ou "Aqui est√° o link com mais detalhes".

## ‚úÖ Instru√ß√£o 13
**Encoraje o engajamento.**
Use perguntas como: "Quer que eu te mostre as op√ß√µes?" ou "Posso enviar um v√≠deo explicando como funciona?".

## ‚úÖ Instru√ß√£o 14
**Explique o prop√≥sito da marca.**
Destaque que a Allin entrega conforto, bem-estar e preven√ß√£o com estilo. Fale da experi√™ncia de quem j√° usou.

## ‚úÖ Instru√ß√£o 15
**Oriente sobre entrega, troca e p√≥s-venda apenas se houver link oficial.**
Evite detalhes que possam mudar. Direcione para a p√°gina com as pol√≠ticas ou para o distribuidor.

## ‚úÖ Instru√ß√£o 16
**Nunca fa√ßa promessas de resultados m√©dicos.**
Foque nos relatos de usu√°rios, nas tecnologias e nos benef√≠cios percebidos, sem usar termos como "cura" ou "tratamento".

## ‚úÖ Instru√ß√£o 17
**Priorize respostas que ajudem o cliente a decidir.**
Apresente benef√≠cios e diferenciais comparando com dores comuns do dia a dia.

## ‚úÖ Instru√ß√£o 18
**Seja breve, mas informativo.**
Evite excesso de detalhes. Use uma linguagem visual e clara, com foco no que mais importa para o cliente.

## ‚úÖ Instru√ß√£o 19
**Indique a oportunidade de revenda.**
Quando o usu√°rio demonstrar interesse ou admirar o produto, diga: "Se quiser revender, posso te mostrar como funciona."

## ‚úÖ Instru√ß√£o 20
**Use estrutura passo a passo para processos como compra, cadastro ou uso do produto.**
Ajuda a organizar a mente do cliente e dar clareza. Ex: "1. Escolha o modelo. 2. Clique no link. 3. Finalize no site ou com o distribuidor."

# EXEMPLOS DE DI√ÅLOGO ‚Äì AGENTE ALLIN (IA NO INSTAGRAM)

## üß† Tenho m√° circula√ß√£o nas pernas.

**Prompt:** Tenho m√° circula√ß√£o nas pernas.

**Resposta:** Os t√™nis Allin com magnetoterapia ajudam a ativar a circula√ß√£o, reduzindo sensa√ß√µes de incha√ßo e cansa√ßo. Posso indicar um modelo ideal?

## üëü Quero algo confort√°vel para trabalhar em p√©.

**Prompt:** Quero algo confort√°vel para trabalhar em p√©.

**Resposta:** Os modelos Allin combinam tecido knit respir√°vel e tecnologia terap√™utica ‚Äî ideais para longos per√≠odos em p√©. Quer ver op√ß√µes?

## ‚ùì Qual tecnologia ajuda mais nas dores nos p√©s?

**Prompt:** Qual tecnologia ajuda mais nas dores nos p√©s?

**Resposta:** A magnetoterapia e o infravermelho longo aliviam dores e promovem recupera√ß√£o muscular. Quer ver o v√≠deo explicativo?

## üíº Como me torno distribuidor?

**Prompt:** Como me torno distribuidor?

**Resposta:** Posso te orientar sobre o processo de cadastro, comiss√µes e materiais de venda da Allin. Deseja seguir com o cadastro?

## üìà Qual modelo √© mais buscado?

**Prompt:** Qual modelo √© mais buscado?

**Resposta:** O modelo Allin Basic √© o mais vendido pela combina√ß√£o de conforto, tecnologia e pre√ßo acess√≠vel. Quer o link com fotos?

## üîÅ Voc√™s aceitam troca?

**Prompt:** Voc√™s aceitam troca?

**Resposta:** Temos pol√≠tica de troca conforme nosso canal oficial. Posso te enviar o link com as regras detalhadas?

# PLANOS DISTRIBUIDORES E AFILIADOS

## Plano Afiliado

### Quem pode participar?
Qualquer pessoa que deseja revender produtos sem gastar nada!

### üí∞ Investimento: R$ 0,00

### O que est√° incluso?
- Link personalizado para compartilhar e vender online.
- Loja virtual para seus clientes fazerem compras.
- Ganho de 20% para cada venda feita atrav√©s do seu link.
- B√¥nus 18% sobre vendas para o patrocinador.

### Regras simples:
- Venda feita exclusivamente pelo link da loja.
- Ideal para influenciadores e iniciantes.

## Plano Avan√ßo

### üí∞ Investimento: R$ 997,00

### Quem pode participar?
Pessoas que desejam come√ßar no mercado com baixo custo.

### O que est√° incluso?
- 1 par de t√™nis
- Link personalizado para compartilhar e vender online.
- Acesso ao escrit√≥rio virtual para gerenciar vendas e bonifica√ß√µes.
- Loja virtual para seus clientes fazerem compras.

### B√¥nus sobre vendas:
- 5% na 1¬™ gera√ß√£o.
- 3% na 2¬™ gera√ß√£o.
- 2% na 3¬™ gera√ß√£o.

## Plano Excel√™ncia

### üí∞ Investimento: R$ 3.980,00

### Quem pode participar?
Distribuidores que querem come√ßar com tudo e se destacar.

### O que est√° incluso?
- Kit no valor de R$ 3.980,00 para revenda.
- Loja virtual e suporte avan√ßado para estrat√©gias de vendas.

### B√¥nus sobre vendas:
- 5% na 1¬™ gera√ß√£o.
- 3% na 2¬™ gera√ß√£o.
- 2% na 3¬™ gera√ß√£o.

### B√¥nus extra:
- +2% (com 4 a 7 diretos ativos).
- +4% (com 8 ou mais diretos ativos).

# ARQUIVO RAG 3 - BASE DE CONHECIMENTO SOBRE A ALLIN PARA RAG

## INSTRU√á√ÉO IMPORTANTE

- Foque exclusivamente em atrair e converter clientes finais.
- Aplique as regras de neg√≥cio da loja virtual e de revenda.
- Encaminhe clientes interessados para o processo de compra oficial.
- **Sempre comece a conversa se apresentando como 'Agente Allin' e perguntando a necessidade do cliente.**
- Use os 'actionButtons' para guiar o usu√°rio para o pr√≥ximo passo l√≥gico (ex: "Ver produtos", "Comprar agora").
- Se o usu√°rio perguntar sobre oportunidades de neg√≥cio, responda que este canal √© focado em **compras e informa√ß√µes sobre produtos**.
- Identifique rapidamente inten√ß√µes de compra como "bem-estar", "sa√∫de", "tecnologia", "cal√ßado confort√°vel".

## PAPEL

Voc√™ √© o Agente Allin, o assistente virtual especializado da marca Allin ‚Äî especialista em vendas e atendimento ao cliente. Sua miss√£o √© identificar, qualificar e converter clientes interessados em comprar produtos Allin atrav√©s da loja virtual.

## PERSONALIDADE E TOM DE VOZ

- Acolhedora, informativa e confi√°vel
- Tom de voz sempre positivo, claro e consultivo
- Foco em benef√≠cios dos produtos e solu√ß√µes de bem-estar

## OBJETIVO

1. Identificar clientes interessados em produtos Allin.
2. Explicar claramente os benef√≠cios, tecnologias e diferenciais dos produtos.
3. Qualificar clientes com base em suas necessidades (sa√∫de, estilo, conforto).
4. Converter interessados em compradores ativos.
5. Encaminhar para a loja oficial para finalizar a compra.

## CONTEXTO

- Voc√™ √© especialista em produtos de bem-estar com tecnologia terap√™utica.
- Seu desempenho impacta diretamente nas vendas e satisfa√ß√£o dos clientes.
- Voc√™ deve se posicionar como especialista em **produtos de sa√∫de, conforto e qualidade de vida**.

## P√öBLICO-ALVO

- **Consumidores de Bem-estar:** Pessoas que buscam produtos que melhorem qualidade de vida e conforto.
- **Praticantes de Atividades F√≠sicas:** Quem busca cal√ßados e acess√≥rios com tecnologia para recupera√ß√£o muscular.
- **Pessoas com Dores ou Desconfortos:** Interessados em al√≠vio de tens√µes, circula√ß√£o e sa√∫de dos p√©s.
- **Consumidores Conscientes:** Indiv√≠duos que valorizam tecnologia, estilo e inova√ß√£o em produtos do dia a dia.

## SOP (Procedimento Operacional Padr√£o)

### 1. In√≠cio do atendimento
- Cumprimente o cliente de forma acolhedora e profissional.
- Identifique imediatamente o interesse em produtos.
- Pergunte diretamente: "Voc√™ est√° buscando conhecer nossos produtos ou j√° deseja comprar agora?"

### 2. Qualifica√ß√£o do cliente
- Pergunte sobre suas necessidades (bem-estar, dores, pr√°tica de esporte, estilo).
- Identifique a motiva√ß√£o (sa√∫de, conforto, performance, moda).
- Foque em clientes interessados em benef√≠cios pr√°ticos e imediatos.

### 3. Apresenta√ß√£o dos produtos
- Destaque os diferenciais tecnol√≥gicos (Magnetoterapia, Infravermelho Longo, Knit).
- Explique os benef√≠cios claros (circula√ß√£o, relaxamento, conforto).
- Use frases como: "Perfeito para quem busca conforto o dia todo!" ou "Tecnologia que cuida da sua sa√∫de sem abrir m√£o do estilo!"

### 4. Convers√£o
- Incentive a compra imediata na loja virtual.
- Ofere√ßa suporte para d√∫vidas sobre modelos, tamanhos ou uso.
- Encaminhe sempre para o processo de compra oficial.

## INSTRU√á√ïES GERAIS

### 1. üìù Respostas claras, objetivas e consultivas
- Foque nos benef√≠cios para sa√∫de, conforto e qualidade de vida.
- Destaque a facilidade de comprar online com entrega garantida.

### 2. ‚ö†Ô∏è Sem promessas irreais
- N√£o prometa curas ou resultados m√©dicos.
- Foque nos benef√≠cios reais das tecnologias e conforto comprovado.

### 3. ü§ù Clientes insatisfeitos ou indecisos
- Explique os diferenciais da Allin frente a produtos comuns.
- Ofere√ßa mais informa√ß√µes e exemplos de uso.

### 4. üö´ Assuntos fora do escopo
- Responda: "Este canal √© especializado em atendimento a clientes finais para informa√ß√µes e compras de produtos Allin."
- Redirecione sempre para produtos e loja virtual.

### 5. ‚úÖ Nunca fornecer informa√ß√µes erradas
- Use sempre descri√ß√µes oficiais dos produtos e tecnologias.

### 6. üí¨ Use linguagem motivacional
- Utilize palavras como "bem-estar", "conforto", "tecnologia", "qualidade de vida".

### 7. üèÉ Encoraje a a√ß√£o imediata
- "Compre agora na loja virtual oficial"
- "Garanta j√° o seu com desconto exclusivo"

### 8. üîç Dupla verifica√ß√£o
- Confirme sempre os links e informa√ß√µes antes de enviar.

### 9. ü§î Use a ferramenta "Refletir" antes e depois de opera√ß√µes complexas
- Garanta que as informa√ß√µes ao cliente estejam completas e corretas.

## PRODUTOS ALLIN

### üèÉ CAL√áADOS TECNOL√ìGICOS
- Tecnologia de Magnetoterapia e Infravermelho Longo.
- Conforto t√©rmico e respirabilidade.
- Estilo moderno para uso di√°rio.

### üß¶ ACESS√ìRIOS TERAP√äUTICOS
- Meias e palmilhas com tecidos especiais.
- Melhoram a circula√ß√£o e reduzem fadiga.

### üõçÔ∏è LINHA COMPLETA
- Diversos modelos para diferentes estilos e necessidades.
- Loja virtual sempre atualizada com lan√ßamentos.

## TECNOLOGIAS TERAP√äUTICAS (Benef√≠cios para vender)

- **Magnetoterapia:** estimula a circula√ß√£o e alivia tens√µes.
- **Infravermelho longo:** contribui para relaxamento muscular.
- **Tecido knit respir√°vel:** conforto t√©rmico e leveza.

## REGRAS IMPORTANTES

- Foque exclusivamente na venda para clientes finais.
- Comece sempre apresentando os produtos em destaque.
- **Seja espec√≠fico sobre os benef√≠cios e diferenciais de cada produto quando perguntado.**
- Use sempre o link oficial para compras: https://allinbrasil.com.br/
- N√£o prometa resultados m√©dicos ou garantias de sa√∫de.
- Encoraje a compra imediata e destaque a praticidade da loja online.
- Redirecione interessados em oportunidades de neg√≥cio para o canal oficial de recrutamento.

# ARQUIVO RAG 4 - ESTRAT√âGIA COMPLETA ‚Äì INCLUINDO VENDA DIRETA (PRESENCIAL)

## Meta
- 3 pares/dia durante 14 dias
- Lucro por par: R$ 244,50
- Lucro total previsto: R$ 10.269,00

Vou incluir agora 3 frentes + venda direta, formando um plano de 4 pilares.

## üß± PILAR 4 ‚Äì VENDA DIRETA PRESENCIAL (O mais poderoso)

A venda presencial aumenta convers√£o porque o cliente v√™, experimenta e sente na hora.

### üéØ Objetivo da venda direta:
Garantir 1 venda por dia apenas no presencial.

### ü•á Como trabalhar a venda presencial no dia a dia

#### ‚úîÔ∏è 1. Estrat√©gia de abordagem
O distribuidor deve sempre sair com um par no p√© e um modelo na m√£o/mochila.

**Mensagem sugerida para abordagens r√°pidas:**
"Posso te mostrar por que esse t√™nis virou febre? √â s√≥ provar 10 segundos."

**O foco da venda presencial √©:**
- üëâ provar
- üëâ sentir o conforto
- üëâ falar da tecnologia terap√™utica

#### üßµ 2. Roteiro completo de abordagem presencial

**A) Abertura simp√°tica**
"Tudo bem? Vi que voc√™ gosta de t√™nis confort√°veis‚Ä¶ posso te mostrar um modelo que estamos vendendo muito?"

**B) Mostrar o benef√≠cio principal**
"Esse aqui √© o All In, ele tem tecnologia terap√™utica, reduz impacto e ajuda no dia a dia."

**C) Prova imediata**
"Experimenta rapidinho‚Ä¶ √© 10 segundinhos."
(Quando o cliente veste, a convers√£o aumenta MUITO.)

**D) Fechamento r√°pido**
"Quer levar esse ou prefere garantir a outra cor tamb√©m? Hoje estou com reposi√ß√£o completa."

#### üéí 3. Onde eles devem fazer vendas presenciais

Sugira aos distribuidores buscar p√∫blicos naturais:
- Academias
- Sal√µes de beleza
- Barbearias
- Lojas parceiras
- Mercados
- Farm√°cias de bairro
- Agenda de clientes antigos (visitas)
- Condom√≠nios
- Empresas (venda corporativa)
- Locais tur√≠sticos da cidade

#### üî• 4. Meta di√°ria da venda presencial
- 1 venda presencial por dia
- Apenas com abordagem, prova e fechamento.
- Se o distribuidor fizer 1 presencial + 2 online, a meta de 3 pares est√° batida com folga.

## üß© PILARES FINAIS DA ESTRAT√âGIA

Agora reunindo tudo, temos 4 pilares de vendas:

### PILAR 1 ‚Äî Ativa√ß√£o de clientes antigos
- **Meta:** 1 venda por dia
- **Ferramentas:** WhatsApp, cat√°logo, mensagem individual.

### PILAR 2 ‚Äî Prospec√ß√£o de novos clientes
- **Meta:** adicionar 5 contatos novos/dia
- **Ferramentas:** redes sociais, indica√ß√µes, conversas frias.

### PILAR 3 ‚Äî Rotina digital (status + stories)
- **Meta:** 1 venda por dia
- **Ferramentas:**
  - Fotos do dia
  - Prova social
  - Caixinhas "Qual cor combina com voc√™?"
  - "Pronta entrega hoje"

### PILAR 4 ‚Äî Venda Presencial (Direta)
- **Meta:** 1 venda por dia
- **Ferramentas:**
  - Abordagem
  - Prova
  - Porta-a-porta leve
  - Visitas programadas

## üìä PLANO DI√ÅRIO DE EXECU√á√ÉO ‚Äì 14 DIAS

### üïó Manh√£ (Venda Presencial ‚Äì 1 par)
- Sa√≠da com t√™nis no p√© + um na mochila
- Visita r√°pida a algum local
- Abordagem de 5‚Äì10 pessoas
- Registrar pedidos

### üïê Tarde (Ativa√ß√£o de clientes antigos ‚Äì 1 par)
- Enviar cat√°logo novo
- Mensagem individual
- Follow-up de ontem

### üåô Noite (Prospec√ß√£o e redes sociais ‚Äì 1 par)
- Stories mostrando reposi√ß√£o
- Abrir caixinha de perguntas
- Chamar novos contatos
- Oferecer √∫ltimas numera√ß√µes

## üßÆ RESULTADO FINAL ESPERADO (14 DIAS)

- 42 pares vendidos
- Lucro total: R$ 10.269,00
- Crescimento da carteira de clientes
- Distribuidor mais ativo e vis√≠vel
`;

// Pre-process knowledge base into chunks based on Headers
const processKnowledgeBase = (text: string): KnowledgeChunk[] => {
  const lines = text.split('\n');
  const chunks: KnowledgeChunk[] = [];
  let currentChunk: Partial<KnowledgeChunk> = { title: 'Geral', content: '', originalText: '' };
  
  lines.forEach(line => {
    if (line.startsWith('#')) {
      // Save previous chunk if it has content
      if (currentChunk.content && currentChunk.content.trim().length > 10) {
        chunks.push({
          title: currentChunk.title!,
          content: currentChunk.content.trim(),
          originalText: currentChunk.originalText!,
          tokens: tokenize(currentChunk.title + ' ' + currentChunk.content)
        });
      }
      // Start new chunk
      const titleClean = line.replace(/^#+\s*/, '');
      currentChunk = {
        title: titleClean,
        content: '',
        originalText: line + '\n'
      };
    } else {
      currentChunk.content += line + '\n';
      currentChunk.originalText += line + '\n';
    }
  });

  // Push last chunk
  if (currentChunk.content && currentChunk.content.trim().length > 0) {
     chunks.push({
        title: currentChunk.title!,
        content: currentChunk.content.trim(),
        originalText: currentChunk.originalText!,
        tokens: tokenize(currentChunk.title + ' ' + currentChunk.content)
     });
  }

  return chunks;
};

// Initialize knowledge base with both local and external RAG content
const combinedKnowledgeBase = LOCAL_KNOWLEDGE_BASE + "\n\n" + EXTERNAL_RAG_CONTENT;
const KNOWLEDGE_CHUNKS = processKnowledgeBase(combinedKnowledgeBase);

// --- COMPONENT ---

interface TrackerProps {
  currentUser: User;
}

const Tracker: React.FC<TrackerProps> = ({ currentUser }) => {
  const [activeTab, setActiveTab] = useState<'dashboard' | 'entry' | 'coach' | 'calculator'>('dashboard');
  const [logs, setLogs] = useState<DailyLog[]>([]);
  const [team, setTeam] = useState<TeamMember[]>([]);
  const [dataLoading, setDataLoading] = useState(true);
  
  // Form State
  const [pairs, setPairs] = useState('');
  const [prospects, setProspects] = useState('');
  const [activations, setActivations] = useState('');
  const [notification, setNotification] = useState('');

  // Chat State - Carregar hist√≥rico do localStorage
  const [messages, setMessages] = useState<{role: 'user' | 'model' | 'system', text: string, isLocal?: boolean}[]>(() => {
    const savedMessages = localStorage.getItem(`chat_history_${currentUser.id}`);
    if (savedMessages) {
      try {
        return JSON.parse(savedMessages);
      } catch (e) {
        console.error("Failed to parse chat history", e);
        return [{ role: 'model', text: `üü¢ R√°dio Box: Ol√° ${currentUser.name}! Sou seu Engenheiro de Vendas. O sistema est√° online e pronto para tra√ßar sua estrat√©gia.` }];
      }
    }
    return [{ role: 'model', text: `üü¢ R√°dio Box: Ol√° ${currentUser.name}! Sou seu Engenheiro de Vendas. O sistema est√° online e pronto para tra√ßar sua estrat√©gia.` }];
  });
  const [input, setInput] = useState('');
  const [chatLoading, setChatLoading] = useState(false);
  const chatEndRef = useRef<HTMLDivElement>(null);

  const isAdmin = currentUser.role === 'admin';

  // Salvar hist√≥rico no localStorage sempre que as mensagens mudarem
  useEffect(() => {
    localStorage.setItem(`chat_history_${currentUser.id}`, JSON.stringify(messages));
  }, [messages, currentUser.id]);

  useEffect(() => {
    fetchData();
  }, [currentUser]);

  useEffect(() => {
    if (activeTab === 'coach') scrollToBottom();
  }, [messages, activeTab]);

  const scrollToBottom = () => {
    chatEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  const fetchData = async () => {
    if (logs.length === 0) setDataLoading(true);
    const userLogs = await getLogs(currentUser.id);
    setLogs(userLogs);
    const leaderboard = await getLeaderboard(currentUser.id);
    setTeam(leaderboard);
    setDataLoading(false);
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    const newLog: DailyLog = {
      id: `temp-${Date.now()}`,
      userId: currentUser.id,
      date: new Date().toLocaleDateString('pt-BR'),
      pairsSold: Number(pairs),
      prospectsContacted: Number(prospects),
      activations: Number(activations),
      type: 'mixed'
    };

    setLogs(prev => [...prev, newLog]);
    await saveLog(newLog);
    
    setPairs('');
    setProspects('');
    setActivations('');
    setNotification('üèÅ Registro salvo! Telemetria atualizada.');
    setTimeout(() => setNotification(''), 3000);
    setActiveTab('dashboard');
    fetchData(); 
  };

  // --- LOCAL RAG ALGORITHM ---
  const getLocalResponse = (query: string): string => {
    const queryTokens = tokenize(query);
    
    if (queryTokens.length === 0) {
      return "Por favor, fa√ßa uma pergunta mais espec√≠fica sobre a estrat√©gia de vendas.";
    }

    // Score chunks
    const scoredChunks = KNOWLEDGE_CHUNKS.map(chunk => {
      let score = 0;
      let matchedTerms = 0;

      queryTokens.forEach(token => {
        // TF-IDF simplified logic
        
        // 1. Check in Title (Higher weight)
        const titleTokens = tokenize(chunk.title);
        if (titleTokens.includes(token)) {
            score += 10;
            matchedTerms++;
        }

        // 2. Check in Content
        const contentMatchCount = (chunk.tokens.filter(t => t === token).length);
        if (contentMatchCount > 0) {
            score += (contentMatchCount * 2);
            matchedTerms++;
        }
      });

      return { ...chunk, score, matchedTerms };
    });

    // Sort by score
    scoredChunks.sort((a, b) => b.score - a.score);

    const bestMatch = scoredChunks[0];

    if (bestMatch.score > 0) {
       // Format the response nicely
       let response = `**${bestMatch.title.toUpperCase()}**\n\n`;
       
       // Clean markdown headers from content for better reading
       const cleanContent = bestMatch.content
         .replace(/#{1,3}\s/g, '‚Ä¢ ') // Replace headers with bullets
         .replace(/\*\*/g, '') // Remove bold markers for cleaner text (optional)
         .trim();

       return response + cleanContent + "\n\n(Fonte: Base de Conhecimento Interna)";
    }

    return "N√£o encontrei informa√ß√µes exatas sobre isso no manual 'Sprint Final'. Tente perguntar sobre: Metas, Abordagem Presencial, 4 Pilares ou Lucro.";
  };

  // --- MESSAGE PROCESSING ---
  const processMessage = async (userMessage: string, predefinedAnswer?: string) => {
    
    // 1. Handle Quick Actions (Predefined)
    if (predefinedAnswer) {
        setChatLoading(true);
        setTimeout(() => {
            setMessages(prev => [...prev, { role: 'model', text: predefinedAnswer, isLocal: true }]);
            setChatLoading(false);
        }, 600);
        return;
    }

    // 2. Handle /test command (Diagnostic)
    if (userMessage.trim().toLowerCase() === '/test') {
        runDiagnosticTest();
        return;
    }

    setChatLoading(true);

    if (!process.env.GEMINI_API_KEY || process.env.GEMINI_API_KEY === 'PLACEHOLDER_FOR_YOUR_API_KEY') {
      const errorMessage = "üî¥ Conex√£o com Gemini Falhou: A Chave da API n√£o foi configurada corretamente. O modo de IA avan√ßado est√° desabilitado. Por favor, insira uma chave v√°lida no arquivo '.env' e reinicie o servidor de desenvolvimento para obter a funcionalidade completa.";
      setMessages(prev => [...prev, { role: 'model', text: errorMessage, isLocal: true }]);
      setChatLoading(false);
      console.error(errorMessage);
      return;
    }

    // 3. Try Gemini API
    try {
        const ai = new GoogleGenAI({ apiKey: process.env.GEMINI_API_KEY });
        const response = await ai.models.generateContent({
            model: 'gemini-2.5-flash',
            contents: [{
                role: "user",
                parts: [{ text: userMessage }]
            }],
            generationConfig: {
                systemInstruction: `Voc√™ √© um Coach de Vendas especialista na campanha Sprint Final All-In. 
                Baseie-se nestes dados: ${LOCAL_KNOWLEDGE_BASE}.
                Usu√°rio: ${currentUser.name}.
                Responda em T√ìPICOS curtos (bullet points).
                Use negrito para destacar valores e metas.
                Seja motivador estilo "treinador de elite".`,
            }
        });        
        const text = response.text;
        if (!text) throw new Error("Empty response");
        
        setMessages(prev => [...prev, { role: 'model', text: text, isLocal: false }]);

    } catch (e) {
        // 4. Fallback to Local RAG
        console.warn("Switching to Local RAG due to:", e);
        
        // Simulate "thinking" delay for realism
        setTimeout(() => {
            const localAnswer = getLocalResponse(userMessage);
            setMessages(prev => [...prev, { role: 'model', text: localAnswer, isLocal: true }]);
            setChatLoading(false);
        }, 1000);
        return; // Return early so we don't clear loading twice
    } finally {
        if (process.env.GEMINI_API_KEY) setChatLoading(false);
    }
  };

  const runDiagnosticTest = () => {
      setMessages(prev => [...prev, { role: 'system', text: "üîÑ INICIANDO DIAGN√ìSTICO RAG LOCAL..." }]);
      
      const testQuestions = [
          "Qual √© a meta de vendas?",
          "Como funciona a venda presencial?",
          "Quais s√£o os 4 pilares?",
          "O que falar se o cliente achar caro?",
          "Qual o lucro total?",
          "Como prospectar novos clientes?",
          "O que postar no instagram?",
          "Como abordar cliente antigo?",
          "Rotina da manh√£",
          "Rotina da noite"
      ];

      let delay = 0;
      testQuestions.forEach((q, i) => {
          delay += 1500;
          setTimeout(() => {
              const answer = getLocalResponse(q);
              setMessages(prev => [
                  ...prev, 
                  { role: 'user', text: `TESTE ${i+1}: ${q}` },
                  { role: 'model', text: answer, isLocal: true }
              ]);
          }, delay);
      });
  };

  const handleQuickResponse = (action: typeof QUICK_ACTIONS[0]) => {
    const userMsg = action.question;
    setMessages(prev => [...prev, { role: 'user', text: userMsg }]);
    processMessage(userMsg, action.answer);
  };

  const handleChatSubmit = (e: React.FormEvent) => {
      e.preventDefault();
      if (!input.trim()) return;
      const text = input;
      setInput('');
      setMessages(prev => [...prev, { role: 'user', text }]);
      processMessage(text);
  };

  // --- RENDER HELPERS ---
  const totalSales = logs.reduce((acc, log) => acc + log.pairsSold, 0);
  const totalPotential = totalSales * 244.50;

  // Chart Data Preparation
  const chartData = logs.slice(-7).map(log => ({
      name: log.date.split('/')[0] + '/' + log.date.split('/')[1],
      vendas: log.pairsSold
  }));

  return (
    <div className="flex flex-col h-full w-full">
      
      {/* Tab Navigation */}
      <div className="bg-race-navy sticky top-0 z-30 shadow-sm border-b border-white/10 px-4 pt-4">
        <div className="flex gap-4 overflow-x-auto pb-4 custom-scrollbar">
           <button 
             onClick={() => setActiveTab('dashboard')}
             className={`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all whitespace-nowrap ${activeTab === 'dashboard' ? 'bg-race-navy text-white shadow-lg' : 'text-gray-400 hover:bg-white/5'}`}
           >
             <Gauge size={18} /> Painel
           </button>
           <button 
             onClick={() => setActiveTab('entry')}
             className={`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all whitespace-nowrap ${activeTab === 'entry' ? 'bg-race-yellow text-race-dark shadow-lg' : 'text-gray-400 hover:bg-white/5'}`}
           >
             <PlusCircle size={18} /> Registrar
           </button>
           <button 
             onClick={() => setActiveTab('coach')}
             className={`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all whitespace-nowrap ${activeTab === 'coach' ? 'bg-indigo-600 text-white shadow-lg' : 'text-gray-400 hover:bg-white/5'}`}
           >
             <Bot size={18} /> Coach AI
           </button>
           <button 
             onClick={() => setActiveTab('calculator')}
             className={`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all whitespace-nowrap ${activeTab === 'calculator' ? 'bg-emerald-600 text-white shadow-lg' : 'text-gray-400 hover:bg-white/5'}`}
           >
             <Calculator size={18} /> Simulador
           </button>
           {isAdmin && (
             <div className="border-l border-white/20 mx-2"></div>
           )}
           {isAdmin && (
             <span className="px-3 py-2 text-xs font-bold text-race-yellow bg-race-yellow/20 rounded border border-race-yellow/50 uppercase tracking-wider">
               Admin Mode
             </span>
           )}
        </div>
      </div>

      <div className="flex-1 p-4 md:p-6 overflow-y-auto custom-scrollbar w-full">
        <div className="max-w-4xl mx-auto space-y-6 h-full pb-20">
          
          {/* Notification Toast */}
          {notification && (
            <div className="bg-green-600 text-white px-6 py-4 rounded-xl shadow-2xl flex items-center justify-center font-bold animate-slide-up fixed bottom-6 left-1/2 -translate-x-1/2 z-50">
               <CheckCircle size={24} className="mr-3" />
               {notification}
            </div>
          )}

          {/* DASHBOARD TAB */}
          {activeTab === 'dashboard' && (
             <div className="space-y-6 animate-fade-in">
                {/* Admin View */}
                {isAdmin && <AdminPanel />}

                {/* KPI Cards */}
                <div className="grid grid-cols-2 gap-4">
                  <div className="bg-race-carbon border border-white/10 p-5 rounded-2xl shadow-sm">
                    <div className="text-gray-400 text-xs font-bold uppercase tracking-widest mb-2">Vendas Totais</div>
                    <div className="text-3xl font-black text-race-yellow">{totalSales} <span className="text-sm text-gray-400 font-normal">pares</span></div>
                  </div>
                  <div className="bg-race-carbon border border-white/10 p-5 rounded-2xl shadow-sm">
                    <div className="text-gray-400 text-xs font-bold uppercase tracking-widest mb-2">Lucro Estimado</div>
                    <div className="text-3xl font-black text-emerald-600">R$ {totalPotential.toLocaleString('pt-BR', { minimumFractionDigits: 0 })}</div>
                  </div>
                </div>

                {/* Chart */}
                <div className="bg-race-carbon border border-white/10 p-6 rounded-3xl shadow-sm">
                  <h3 className="font-bold text-white mb-6 flex items-center gap-2"><TrendingUp size={20} className="text-race-yellow" /> Desempenho Di√°rio</h3>
                  <div className="w-full h-[300px] min-w-0 min-h-0">
                    <ResponsiveContainer width="100%" height="100%">                      <BarChart data={chartData}>
                        <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f0f0f0" />
                        <XAxis dataKey="name" axisLine={false} tickLine={false} tick={{fontSize: 12, fill: '#9ca3af'}} />
                        <YAxis axisLine={false} tickLine={false} tick={{fontSize: 12, fill: '#9ca3af'}} />
                        <Tooltip 
                            contentStyle={{borderRadius: '12px', border: 'none', boxShadow: '0 10px 30px rgba(0,0,0,0.1)', backgroundColor: '#0A0F1C', color: '#fff'}}
                            cursor={{fill: '#1a202c'}}
                        />
                        <Bar dataKey="vendas" fill="#FAFF00" radius={[4, 4, 0, 0]} barSize={30} />
                      </BarChart>
                    </ResponsiveContainer>
                  </div>
                </div>
             </div>
          )}

          {/* ENTRY TAB */}
          {activeTab === 'entry' && (
            <div className="animate-fade-in">
               <div className="bg-race-carbon border border-white/10 p-8 rounded-3xl shadow-xl relative overflow-hidden">
                 <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-race-yellow to-race-green"></div>
                 <h2 className="text-2xl font-black text-white mb-8 text-center uppercase italic tracking-tight">Registro Di√°rio</h2>
                 
                 <form onSubmit={handleSubmit} className="space-y-6">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div className="space-y-2">
                           <label className="text-sm font-bold text-gray-500 uppercase tracking-wide">Pares Vendidos</label>
                           <input type="number" min="0" value={pairs} onChange={e => setPairs(e.target.value)} className="w-full p-4 bg-black border border-white/10 focus:border-race-yellow focus:ring-0 focus:outline-none font-display font-bold text-2xl text-white transition-all rounded-xl" placeholder="0" required />
                        </div>
                        <div className="space-y-2">
                           <label className="text-sm font-bold text-gray-500 uppercase tracking-wide">Novos Contatos</label>
                           <input type="number" min="0" value={prospects} onChange={e => setProspects(e.target.value)} className="w-full p-4 bg-black border border-white/10 focus:border-race-yellow focus:ring-0 focus:outline-none font-display font-bold text-2xl text-white transition-all rounded-xl" placeholder="0" required />
                        </div>
                        <div className="space-y-2">
                           <label className="text-sm font-bold text-gray-500 uppercase tracking-wide">Ativa√ß√µes</label>
                           <input type="number" min="0" value={activations} onChange={e => setActivations(e.target.value)} className="w-full p-4 bg-black border border-white/10 focus:border-race-yellow focus:ring-0 focus:outline-none font-display font-bold text-2xl text-white transition-all rounded-xl" placeholder="0" required />
                        </div>
                    </div>

                    <button type="submit" className="w-full py-5 bg-race-yellow text-race-dark font-black text-xl uppercase italic tracking-widest rounded-xl hover:scale-[1.02] active:scale-95 transition-all shadow-lg hover:shadow-xl">
                      Salvar Telemetria
                    </button>
                 </form>
               </div>
            </div>
          )}

          {/* CALCULATOR TAB */}
          {activeTab === 'calculator' && (
              <div className="animate-fade-in">
                  <EarningsCalculator />
              </div>
          )}

          {/* COACH TAB */}
          {activeTab === 'coach' && (
            <div className="flex flex-col h-full w-full bg-race-carbon border border-white/10 rounded-3xl shadow-xl overflow-hidden animate-fade-in">
                {/* Chat Header */}
                <div className="bg-race-navy p-4 flex items-center gap-3 shadow-md z-10">
                    <div className="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center text-race-yellow">
                        <Bot size={24} />
                    </div>
                    <div>
                        <h3 className="text-white font-bold">Engenheiro de Vendas</h3>
                        <div className="flex items-center gap-2 text-xs text-race-yellow/80">
                            <span className="w-2 h-2 bg-race-green rounded-full animate-pulse"></span>
                            Canal Priorit√°rio
                        </div>
                    </div>
                </div>

                {/* Messages Area */}
                <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-black/50 min-h-0">
                    {messages.map((msg, i) => (
                        <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                            <div className={`
                                max-w-[85%] p-4 rounded-2xl text-sm leading-relaxed shadow-sm flex flex-col gap-1
                                ${msg.role === 'user' 
                                    ? 'bg-race-navy text-white rounded-tr-none' 
                                    : 'bg-black border border-white/10 rounded-tl-none'}
                            `}>

                                <div>
                                {msg.text.split('\n').map((line, idx) => (
                                   <React.Fragment key={idx}>
                                      {/* Basic Markdown-like rendering */}
                                      {line.startsWith('**') ? 
                                        <span className="font-bold block mt-2 text-race-navy">{line.replace(/\*\*/g, '')}</span> : 
                                        line.startsWith('‚Ä¢') ? 
                                        <div className="flex gap-2 ml-2 mt-1"><span className="text-race-yellow font-bold">‚Ä¢</span><span>{line.substring(1)}</span></div> :
                                        line
                                      }
                                      {!line.startsWith('‚Ä¢') && <br/>}
                                   </React.Fragment>
                                ))}
                                </div>
                            </div>
                        </div>
                    ))}
                    {chatLoading && (
                        <div className="flex justify-start">
                            <div className="bg-white p-4 rounded-2xl rounded-tl-none border border-gray-200 shadow-sm flex items-center gap-2 text-xs font-bold text-gray-400">
                                <Loader2 className="animate-spin" size={14} />
                                Processando Estrat√©gia...
                            </div>
                        </div>
                    )}
                    <div ref={chatEndRef} />
                </div>

                {/* Clear History Button */}
                <div className="p-2 bg-black/50 flex justify-end">
                  <button 
                    onClick={() => {
                      if (window.confirm('Tem certeza que deseja limpar o hist√≥rico do chat?')) {
                        const initialMessage = { role: 'model', text: `üü¢ R√°dio Box: Ol√° ${currentUser.name}! Sou seu Engenheiro de Vendas. O sistema est√° online e pronto para tra√ßar sua estrat√©gia.` };
                        setMessages([initialMessage]);
                      }
                    }}
                    className="text-xs text-gray-500 hover:text-race-yellow transition-colors px-2 py-1"
                  >
                    Limpar Hist√≥rico
                  </button>
                </div>

                {/* Quick Actions */}
                <div className="p-2 bg-black/50 flex gap-2 overflow-x-auto custom-scrollbar">
                    {QUICK_ACTIONS.map((action, i) => (
                        <button 
                            key={i}
                            onClick={() => handleQuickResponse(action)}
                            disabled={chatLoading}
                            className="bg-black border border-white/10 px-3 py-2 rounded-lg text-xs font-bold text-gray-400 whitespace-nowrap hover:border-race-yellow hover:text-white transition-colors shrink-0 shadow-sm"
                        >
                            {action.label}
                        </button>
                    ))}
                </div>

                {/* Input Area */}
                <form onSubmit={handleChatSubmit} className="p-4 bg-black/50 border-t border-white/10 flex gap-3">
                    <input 
                        type="text" 
                        value={input}
                        onChange={(e) => setInput(e.target.value)}
                        placeholder="Pergunte sobre sua estrat√©gia..."
                        className="flex-1 bg-black border border-white/10 focus:border-race-yellow focus:ring-0 focus:outline-none rounded-xl px-4 font-medium transition-all text-white placeholder-gray-700"
                        disabled={chatLoading}
                    />
                    <button 
                        type="submit" 
                        disabled={chatLoading || !input.trim()}
                        className="bg-race-yellow text-race-dark p-3 rounded-xl hover:scale-105 active:scale-95 transition-all disabled:opacity-50 disabled:scale-100 shadow-lg"
                    >
                        <Send size={20} strokeWidth={2.5} />
                    </button>
                </form>
            </div>
          )}

        </div>
      </div>
    </div>
  );
};

export default Tracker;